# =============================================================================
# DJAlgoRhythm Configuration
# =============================================================================
#
# Copy this file to .env and update with your values
# All environment variables have CLI flag equivalents (use --help to see them)
#
# Format: DJALGORHYTHM_<SECTION>_<SETTING>=value
# CLI equivalent: --<section>-<setting>
#
# =============================================================================
# CHAT PLATFORMS - Choose one primary platform
# =============================================================================

# -----------------------------------------------------------------------------
# Telegram Configuration (Recommended - Default enabled)
# -----------------------------------------------------------------------------
# CLI: --telegram-enabled, --telegram-bot-token, --telegram-group-id
DJALGORHYTHM_TELEGRAM_ENABLED=true                           # Enable Telegram bot (default: true)
DJALGORHYTHM_TELEGRAM_BOT_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11  # Bot token from @BotFather
DJALGORHYTHM_TELEGRAM_GROUP_ID=-100xxxxxxxxxx                # Group ID (get from @userinfobot)

# Admin and Community Approval
# CLI: --admin-needs-approval, --community-approval
DJALGORHYTHM_ADMIN_APPROVAL=false                           # Require admin approval for all songs (default: false)
DJALGORHYTHM_ADMIN_NEEDS_APPROVAL=false                     # Require approval even from admins - for testing (default: false)
DJALGORHYTHM_COMMUNITY_APPROVAL=0                           # Number of üëç reactions to bypass admin approval, 0=disabled (default: 0)

# =============================================================================
# SPOTIFY CONFIGURATION - Required
# =============================================================================
# Get these from https://developer.spotify.com/dashboard
# CLI: --spotify-client-id, --spotify-client-secret, --spotify-playlist-id

DJALGORHYTHM_SPOTIFY_CLIENT_ID=your_spotify_client_id_here          # Spotify app client ID
DJALGORHYTHM_SPOTIFY_CLIENT_SECRET=your_spotify_client_secret_here  # Spotify app client secret
DJALGORHYTHM_SPOTIFY_PLAYLIST_ID=your_target_playlist_id_here       # Target playlist ID (from Spotify URL)
DJALGORHYTHM_SPOTIFY_REDIRECT_URL=http://127.0.0.1:8080/callback    # OAuth callback URL (default: auto-generated)
DJALGORHYTHM_SPOTIFY_TOKEN_PATH=./spotify_token.json                # Token storage path (default: "./spotify_token.json")

# =============================================================================
# AI/LLM CONFIGURATION - Required for song disambiguation
# =============================================================================

# -----------------------------------------------------------------------------
# LLM Provider Selection
# -----------------------------------------------------------------------------
# CLI: --llm-provider, --llm-api-key, --llm-model
DJALGORHYTHM_LLM_PROVIDER=openai                              # Provider: openai, anthropic, ollama (REQUIRED)

# -----------------------------------------------------------------------------
# OpenAI Configuration (Recommended for best results)
# -----------------------------------------------------------------------------
# Uncomment these lines and set DJALGORHYTHM_LLM_PROVIDER=openai
# DJALGORHYTHM_LLM_API_KEY=sk-...                           # OpenAI API key
# DJALGORHYTHM_LLM_MODEL=gpt-4o-mini                        # Model name (gpt-4o-mini is cost-effective)

# -----------------------------------------------------------------------------
# Anthropic Configuration
# -----------------------------------------------------------------------------
# Uncomment these lines and set DJALGORHYTHM_LLM_PROVIDER=anthropic
# DJALGORHYTHM_LLM_API_KEY=sk-ant-...                       # Anthropic API key
# DJALGORHYTHM_LLM_MODEL=claude-3-haiku-20240307           # Model name (Haiku is fastest/cheapest)

# -----------------------------------------------------------------------------
# Ollama Configuration (Local/Self-hosted)
# -----------------------------------------------------------------------------
# Uncomment these lines and set DJALGORHYTHM_LLM_PROVIDER=ollama
# DJALGORHYTHM_LLM_BASE_URL=http://localhost:11434          # Ollama server URL (default: http://localhost:11434)
# DJALGORHYTHM_LLM_MODEL=llama3.2                          # Model name (must be installed in Ollama)

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# -----------------------------------------------------------------------------
# Localization
# -----------------------------------------------------------------------------
# CLI: --language
DJALGORHYTHM_LANGUAGE=en                                    # Bot language: en, ch_be (default: en)

# -----------------------------------------------------------------------------
# Timeouts and Retries (all values in seconds)
# -----------------------------------------------------------------------------
# CLI: --confirm-timeout-secs, --confirm-admin-timeout-secs, etc.
DJALGORHYTHM_CONFIRM_TIMEOUT_SECS=120                       # User confirmation timeout (default: 120)
DJALGORHYTHM_CONFIRM_ADMIN_TIMEOUT_SECS=3600               # Admin confirmation timeout (default: 3600)
DJALGORHYTHM_QUEUE_TRACK_APPROVAL_TIMEOUT_SECS=30          # Queue track approval timeout (default: 30)
DJALGORHYTHM_MAX_QUEUE_TRACK_REPLACEMENTS=3                # Max replacement attempts before auto-accept (default: 3)

# -----------------------------------------------------------------------------
# Queue Management - Ensures continuous playback
# -----------------------------------------------------------------------------
# CLI: --queue-ahead-duration-secs, --queue-check-interval-secs
DJALGORHYTHM_QUEUE_AHEAD_DURATION_SECS=90                  # Target queue duration ahead of current song (default: 90)
DJALGORHYTHM_QUEUE_CHECK_INTERVAL_SECS=45                  # How often to check queue status (default: 45)
DJALGORHYTHM_QUEUE_SYNC_WARNING_TIMEOUT_MINUTES=30         # Warning timeout for queue sync issues (default: 30)

# -----------------------------------------------------------------------------
# Shadow Queue - Maintains reliable queue state tracking
# -----------------------------------------------------------------------------
# CLI: --shadow-queue-maintenance-interval-mins, --shadow-queue-max-age-hours
DJALGORHYTHM_SHADOW_QUEUE_MAINTENANCE_INTERVAL_SECS=30     # Maintenance interval in seconds (CLI uses minutes!) (default: converted from 5 mins)
DJALGORHYTHM_SHADOW_QUEUE_MAX_AGE_HOURS=2                  # Max age of shadow queue items (default: 2)

# -----------------------------------------------------------------------------
# Flood Prevention - Anti-spam protection
# -----------------------------------------------------------------------------
# CLI: --flood-limit-per-minute
DJALGORHYTHM_FLOOD_LIMIT_PER_MINUTE=6                      # Max messages per user per minute (default: 6)

# -----------------------------------------------------------------------------
# HTTP Server Configuration
# -----------------------------------------------------------------------------
# CLI: --server-host, --server-port
DJALGORHYTHM_SERVER_HOST=127.0.0.1                         # Server bind address (default: 0.0.0.0)
DJALGORHYTHM_SERVER_PORT=8080                              # Server port (default: 8080)

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
# CLI: --log-level
DJALGORHYTHM_LOG_LEVEL=info                                # Log level: debug, info, warn, error (default: info)
DJALGORHYTHM_LOG_FORMAT=text                               # Log format: json, text (default: text)

# =============================================================================
# QUICK SETUP GUIDE
# =============================================================================

# 1. TELEGRAM SETUP (Recommended):
#    - Message @BotFather on Telegram
#    - Create bot with /newbot command
#    - Copy bot token to DJALGORHYTHM_TELEGRAM_BOT_TOKEN above
#    - Add bot to your group as admin
#    - Get group ID with @userinfobot and set DJALGORHYTHM_TELEGRAM_GROUP_ID above
#    - Optional: Enable admin approval by setting DJALGORHYTHM_ADMIN_APPROVAL=true

# 2. SPOTIFY SETUP (Required):
#    - Go to https://developer.spotify.com/dashboard
#    - Create new app with name "DJAlgoRhythm"
#    - Add redirect URI: http://127.0.0.1:8080/callback
#    - Copy Client ID and Secret to config above
#    - Get target playlist ID from Spotify URL (the part after /playlist/)
#    - Make sure playlist is public or owned by the authenticating user

# 3. AI SETUP (Required):
#    - For OpenAI: Get API key from https://platform.openai.com/api-keys
#    - For Anthropic: Get API key from https://console.anthropic.com/
#    - For Ollama: Install locally and run `ollama pull llama3.2`
#    - Set provider and credentials above

# 4. TEST CONFIGURATION:
#    go run ./cmd/djalgorhythm --help                        # See all CLI options
#    go run ./cmd/djalgorhythm --log-level=debug            # Run with debug logging
#    make build && ./bin/djalgorhythm                       # Build and run

# =============================================================================
# TROUBLESHOOTING
# =============================================================================

# Issue: "Bot doesn't respond to messages"
# - Check DJALGORHYTHM_TELEGRAM_GROUP_ID is correct (negative number for groups)
# - Ensure bot is admin in the group
# - Check bot token is valid with curl: curl https://api.telegram.org/bot<TOKEN>/getMe

# Issue: "Spotify authentication fails"
# - Verify redirect URL in Spotify app matches DJALGORHYTHM_SPOTIFY_REDIRECT_URL
# - Check client ID and secret are correct
# - Ensure playlist exists and is accessible

# Issue: "LLM not working"
# - Check API key is valid for chosen provider
# - For Ollama: ensure model is pulled with `ollama pull <model>`
# - Check rate limits and quotas for paid providers

# Issue: "Songs not being added"
# - Check playlist permissions (must be public or owned by auth user)
# - Verify Spotify Premium account (required for queue manipulation)
# - Check logs with DJALGORHYTHM_LOG_LEVEL=debug
